import { Button } from "@/components/button/Button";
// import { LoadingSVG } from "@/components/button/LoadingSVG";
// import { SettingsDropdown } from "@/components/playground/SettingsDropdown";
// import { useConfig } from "@/hooks/useConfig";
import { ConnectionState } from "livekit-client";
import { ReactNode, useEffect, useState } from "react";

type PlaygroundHeader = {
  logo?: ReactNode;
  // title?: ReactNode;
  // githubLink?: string;
  height: number;
  accentColor: string;
  connectionState: ConnectionState;
  // onConnectClicked: () => void;
};

const formatTimeInterval = (seconds: number) => {
  const hours = Math.floor(seconds / 3600);
  const minutes = Math.floor((seconds % 3600) / 60);
  const secs = seconds % 60;

  let result = '';

  if (hours > 0) {
    result += `${hours}h `;
  }

  if (minutes > 0 || hours > 0) {
    result += `${minutes}m `;
  }

  result += `${String(secs).padStart(2, '0')}s`

  return result.trim();
};

export const PlaygroundHeader = ({
  logo,
  accentColor,
  height,
  connectionState,
}: PlaygroundHeader) => {
  const [elapsedSeconds, setElapsedSeconds] = useState(0);

  const isRunning = connectionState === ConnectionState.Connected || connectionState === ConnectionState.SignalReconnecting;

  useEffect(() => {
    let interval: NodeJS.Timeout | null = null;
    if (isRunning) {
      interval = setInterval(() => {
        setElapsedSeconds((prev) => prev + 1);
      }, 1000);
    } else if (!isRunning && elapsedSeconds !== 0) {
      clearInterval(interval!);
    }

    return () => clearInterval(interval!);
  }, [isRunning]);

  return (
    <div
      className={`flex gap-4 pt-4 text-${accentColor}-500 justify-between items-center shrink-0`}
      style={{
        height: height + "px",
      }}
    >
      <div className="flex items-center gap-3 basis-2/3">
        <div className="flex lg:basis-1/2">
          <a>{logo ?? <Logo />}</a>
        </div>
      </div>
      <div className="flex basis-1/3 justify-end items-center gap-2">
        <Button data-state="closed" accentColor="gray" disabled={true}>
          <div className="inline-flex gap-2 flex-nowrap text-nowrap ml-auto px-3 py-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-timer"><line x1="10" x2="14" y1="2" y2="2"></line><line x1="12" x2="15" y1="14" y2="11"></line><circle cx="12" cy="14" r="8"></circle></svg>
            <span className="w-12">{formatTimeInterval(elapsedSeconds)}</span>
          </div>
        </Button>
      </div>
    </div>
  );
};

const Logo = () => (
  <svg id="a" xmlns="http://www.w3.org/2000/svg" className="w-[180px] lg:w-[250px]" viewBox="0 0 1454.6 373.45"><polygon points="1441.86 238.46 1392.71 146.71 1383.89 151.43 1430.51 238.46 1441.86 238.46" fill="white" strokeWidth="0"/><path d="M1388.68,341.35h6.02v31.15h-6.02v-31.15Z" fill="white" strokeWidth="0"/><path d="M1430.6,365.25l1.16,5.38c-3.29,1.54-6.43,2.31-9.43,2.31-1.85,0-3.57-.3-5.17-.91-1.6-.61-3.07-1.53-4.39-2.76s-2.37-2.9-3.13-5.01c-.76-2.11-1.14-4.55-1.14-7.34s.38-5.23,1.14-7.34c.76-2.11,1.81-3.78,3.13-5.01s2.79-2.15,4.39-2.76c1.61-.61,3.33-.91,5.17-.91,2.99,0,6.14.77,9.43,2.31l-1.24,5.38c-2.75-1.25-5.21-1.87-7.38-1.87-2.51,0-4.57.89-6.18,2.67s-2.41,4.29-2.41,7.52.8,5.74,2.41,7.52,3.66,2.67,6.18,2.67c2.01,0,4.49-.62,7.46-1.87Z" fill="white" strokeWidth="0"/><path d="M1402.77,155.35h-104.29v-10h104.29c23.06,0,41.82-18.76,41.82-41.82s-18.76-41.82-41.82-41.82h-103.86v-10h103.86c28.58,0,51.83,23.25,51.83,51.83s-23.25,51.83-51.83,51.83Z" fill="white" strokeWidth="0"/><path d="M480.67,237.89l-86.31-190.76h34.85l51.33,118.25,51.6-118.25h34.85l-86.31,190.76" fill="white" strokeWidth="0"/><path d="M641.14,59.94c14.5-8.54,30.3-12.81,47.41-12.81s32.91,4.27,47.41,12.81c14.49,8.54,25.98,20.12,34.44,34.75,8.46,14.63,12.7,30.57,12.7,47.83s-4.23,33.2-12.7,47.83c-8.47,14.63-19.95,26.21-34.44,34.75-14.5,8.54-30.3,12.81-47.41,12.81s-32.92-4.27-47.41-12.81c-14.5-8.54-25.98-20.12-34.44-34.75-8.47-14.62-12.7-30.56-12.7-47.83s4.23-33.2,12.7-47.83c8.46-14.62,19.94-26.2,34.44-34.75ZM644.79,186.66c12.06,12.17,26.65,18.26,43.76,18.26s31.7-6.08,43.76-18.26c12.06-12.17,18.1-26.89,18.1-44.15s-6.04-31.97-18.1-44.15c-12.07-12.17-26.66-18.26-43.76-18.26s-31.7,6.09-43.76,18.26c-12.07,12.17-18.1,26.89-18.1,44.15s6.03,31.98,18.1,44.15Z" fill="white" strokeWidth="0"/><path d="M832.12,237.89V47.13h32.69v161.12l-32.69,29.64Z" fill="white" strokeWidth="0"/><path d="M1042.41,186.66l22.96,23.44c-8.64,8.72-18.73,15.53-30.26,20.44-11.53,4.91-23.68,7.36-36.47,7.36-17.11,0-32.92-4.27-47.41-12.81-14.5-8.54-25.98-20.12-34.44-34.75-8.47-14.62-12.7-30.56-12.7-47.83s4.23-33.2,12.7-47.83c8.46-14.62,19.94-26.2,34.44-34.75,14.5-8.54,30.3-12.81,47.41-12.81,6.48,0,12.83.64,19.04,1.91,6.21,1.27,12.16,3.13,17.83,5.59,5.67,2.45,11.03,5.41,16.07,8.86,5.04,3.45,9.63,7.36,13.78,11.72l-22.96,23.16c-12.07-12.17-26.66-18.26-43.76-18.26s-31.7,6.09-43.76,18.26c-12.07,12.17-18.1,26.89-18.1,44.15s6.03,31.98,18.1,44.15c12.06,12.17,26.65,18.26,43.76,18.26s31.7-6.08,43.76-18.26Z" fill="white" strokeWidth="0"/><path d="M1248.56,80.11h-133.18v-32.97h133.18v32.97ZM1232.81,159.14h-117.43v-33.25h117.43v33.25ZM1248.56,237.89h-133.18v-32.97h133.18v32.97Z" fill="white" strokeWidth="0"/><rect x="380.31" y="306.21" width="1072.69" height="5" fill="white" strokeWidth="0"/><path d="M495.03,341.35v5.74h-8.66v25.41h-6.02v-25.41h-8.66v-5.74h23.34Z" fill="white" strokeWidth="0"/><path d="M507.38,341.35h6.02v20.29c0,1.57.59,2.88,1.76,3.92s2.66,1.56,4.45,1.56,3.27-.52,4.45-1.56c1.18-1.04,1.76-2.34,1.76-3.92v-20.29h6.02v21c0,3.5-1.1,6.14-3.31,7.92-2.21,1.78-5.18,2.67-8.92,2.67s-6.72-.89-8.92-2.67c-2.21-1.78-3.31-4.42-3.31-7.92v-21Z" fill="white" strokeWidth="0"/><path d="M546.45,341.35h10.55c3.72,0,6.44.87,8.16,2.6,1.72,1.74,2.59,4.1,2.59,7.1,0,4.54-1.82,7.49-5.45,8.85l2.81,5.16c.27.51.49.89.68,1.16.19.27.43.52.74.76.31.24.68.34,1.12.31.44-.03.97-.16,1.58-.4l-1,5.79c-.88.15-1.65.24-2.31.27-.65.03-1.24-.04-1.76-.2-.52-.16-.95-.33-1.28-.51-.33-.18-.68-.5-1.02-.96-.35-.46-.62-.86-.82-1.2-.2-.34-.49-.85-.86-1.53l-4.17-7.79h-3.53v11.75h-6.02v-31.15ZM557.96,347.09h-5.49v7.92h5.49c1.23,0,2.16-.36,2.79-1.07.63-.71.94-1.68.94-2.89s-.31-2.18-.94-2.89c-.63-.71-1.56-1.07-2.79-1.07Z" fill="white" strokeWidth="0"/><path d="M581.82,341.35h4.57l14.6,19.75v-19.75h6.02v31.15h-4.49l-14.68-19.84v19.84h-6.02v-31.15Z" fill="white" strokeWidth="0"/><path d="M621.61,341.35h6.02v31.15h-6.02v-31.15Z" fill="white" strokeWidth="0"/><path d="M642.23,341.35h4.57l14.6,19.75v-19.75h6.02v31.15h-4.49l-14.68-19.84v19.84h-6.02v-31.15Z" fill="white" strokeWidth="0"/><path d="M739.13,341.35h18.93v5.74h-12.91v6.45h11.71v5.74h-11.71v7.48h12.91v5.74h-18.93v-31.15Z" fill="white" strokeWidth="0"/><path d="M768.97,341.35h6.42l7.42,22.25,7.42-22.25h6.42l-11.07,31.15h-5.54l-11.07-31.15Z" fill="white" strokeWidth="0"/><path d="M809,341.35h18.93v5.74h-12.91v6.45h11.71v5.74h-11.71v7.48h12.91v5.74h-18.93v-31.15Z" fill="white" strokeWidth="0"/><path d="M841.08,341.35h10.55c3.72,0,6.44.87,8.16,2.6,1.72,1.74,2.59,4.1,2.59,7.1,0,4.54-1.82,7.49-5.45,8.85l2.81,5.16c.27.51.49.89.68,1.16.19.27.43.52.74.76.31.24.68.34,1.12.31.44-.03.97-.16,1.58-.4l-1,5.79c-.88.15-1.65.24-2.31.27-.66.03-1.24-.04-1.77-.2-.52-.16-.95-.33-1.28-.51-.33-.18-.68-.5-1.02-.96-.35-.46-.62-.86-.82-1.2-.2-.34-.49-.85-.86-1.53l-4.17-7.79h-3.53v11.75h-6.02v-31.15ZM852.6,347.09h-5.5v7.92h5.5c1.23,0,2.16-.36,2.79-1.07s.94-1.68.94-2.89-.31-2.18-.94-2.89-1.56-1.07-2.79-1.07Z" fill="white" strokeWidth="0"/><path d="M890.34,359.86v12.64h-6.02v-12.64l-10.51-18.51h6.82l6.7,12.59,6.7-12.59h6.82l-10.51,18.51Z" fill="white" strokeWidth="0"/><path d="M995.22,372.94c-1.82,0-3.57-.3-5.25-.91-1.68-.61-3.26-1.52-4.73-2.74-1.47-1.22-2.65-2.89-3.55-5.03-.9-2.14-1.34-4.58-1.34-7.34s.45-5.2,1.34-7.34c.9-2.14,2.08-3.81,3.55-5.03,1.47-1.22,3.05-2.13,4.73-2.74,1.68-.61,3.44-.91,5.25-.91,1.42,0,2.81.19,4.17.56,1.36.37,2.7.96,4.01,1.78s2.45,1.83,3.43,3.05c.98,1.22,1.76,2.74,2.35,4.56.59,1.82.88,3.85.88,6.07s-.29,4.25-.88,6.07c-.59,1.82-1.37,3.34-2.35,4.56-.98,1.22-2.12,2.23-3.43,3.05s-2.65,1.41-4.01,1.78c-1.36.37-2.75.56-4.17.56ZM1001.5,364.47c1.67-1.77,2.51-4.28,2.51-7.54s-.84-5.78-2.51-7.54c-1.67-1.76-3.76-2.65-6.28-2.65s-4.68.88-6.34,2.65c-1.66,1.77-2.49,4.28-2.49,7.54s.83,5.78,2.49,7.54c1.66,1.77,3.77,2.65,6.34,2.65s4.6-.88,6.28-2.65Z" fill="white" strokeWidth="0"/><path d="M1023.86,341.35h10.55c3.72,0,6.44.87,8.16,2.6,1.72,1.74,2.59,4.1,2.59,7.1,0,4.54-1.82,7.49-5.45,8.85l2.81,5.16c.27.51.49.89.68,1.16.19.27.43.52.74.76.31.24.68.34,1.12.31.44-.03.97-.16,1.58-.4l-1,5.79c-.88.15-1.65.24-2.31.27-.66.03-1.24-.04-1.77-.2-.52-.16-.95-.33-1.28-.51-.33-.18-.68-.5-1.02-.96-.35-.46-.62-.86-.82-1.2-.2-.34-.49-.85-.86-1.53l-4.17-7.79h-3.53v11.75h-6.02v-31.15ZM1035.37,347.09h-5.5v7.92h5.5c1.23,0,2.16-.36,2.79-1.07s.94-1.68.94-2.89-.31-2.18-.94-2.89-1.56-1.07-2.79-1.07Z" fill="white" strokeWidth="0"/><path d="M1059.23,341.35h7.9c2.38,0,4.53.28,6.44.84,1.91.56,3.64,1.43,5.17,2.6,1.54,1.17,2.73,2.79,3.57,4.85.84,2.06,1.26,4.49,1.26,7.27s-.42,5.21-1.26,7.28c-.84,2.06-2.03,3.68-3.57,4.85-1.54,1.17-3.26,2.04-5.17,2.6-1.91.56-4.06.84-6.44.84h-7.9v-31.15ZM1067.14,347.09h-1.88v19.67h1.88c6.93,0,10.39-3.28,10.39-9.83s-3.46-9.83-10.39-9.83Z" fill="white" strokeWidth="0"/><path d="M1116.23,341.35h6.02v31.15h-6.02v-31.15Z" fill="white" strokeWidth="0"/><path d="M1136.84,341.35h4.57l14.6,19.75v-19.75h6.02v31.15h-4.49l-14.68-19.84v19.84h-6.02v-31.15Z" fill="white" strokeWidth="0"/><path d="M1197.73,341.35v5.74h-8.66v25.41h-6.02v-25.41h-8.66v-5.74h23.34Z" fill="white" strokeWidth="0"/><path d="M1221.75,372.94c-1.82,0-3.57-.3-5.25-.91-1.68-.61-3.26-1.52-4.73-2.74-1.47-1.22-2.65-2.89-3.55-5.03-.9-2.14-1.34-4.58-1.34-7.34s.45-5.2,1.34-7.34c.9-2.14,2.08-3.81,3.55-5.03,1.47-1.22,3.05-2.13,4.73-2.74,1.68-.61,3.44-.91,5.25-.91,1.42,0,2.81.19,4.17.56,1.36.37,2.7.96,4.01,1.78s2.45,1.83,3.43,3.05c.98,1.22,1.76,2.74,2.35,4.56s.88,3.85.88,6.07-.29,4.25-.88,6.07c-.59,1.82-1.37,3.34-2.35,4.56-.98,1.22-2.12,2.23-3.43,3.05s-2.65,1.41-4.01,1.78c-1.36.37-2.75.56-4.17.56ZM1228.03,364.47c1.67-1.77,2.51-4.28,2.51-7.54s-.84-5.78-2.51-7.54c-1.67-1.76-3.76-2.65-6.28-2.65s-4.68.88-6.34,2.65c-1.66,1.77-2.49,4.28-2.49,7.54s.83,5.78,2.49,7.54c1.66,1.77,3.77,2.65,6.34,2.65s4.6-.88,6.28-2.65Z" fill="white" strokeWidth="0"/><path d="M1316.81,372.5h-6.42l11.07-31.15h5.54l11.07,31.15h-6.42l-1.97-5.92h-10.91l-1.96,5.92ZM1324.23,350.25l-3.77,11.3h7.54l-3.77-11.3Z" fill="white" strokeWidth="0"/><rect y="113.09" width="37.26" height="148.69" rx="17.95" ry="17.95" fill="currentColor" strokeWidth="0"/><rect x="299.91" y="112.91" width="37.26" height="148.69" rx="17.95" ry="17.95" fill="currentColor" strokeWidth="0"/><rect x="74.71" y="57.06" width="37.26" height="260.39" rx="17.95" ry="17.95" fill="currentColor" strokeWidth="0"/><rect x="225.11" y="57.58" width="37.26" height="260.39" rx="17.95" ry="17.95" fill="currentColor" strokeWidth="0"/><rect x="150.08" width="37.26" height="373.11" rx="17.95" ry="17.95" fill="currentColor" strokeWidth="0"/><path d="M706.3,356.29v15.19c-2.77.91-5.89,1.47-10.26,1.47-8.7,0-14.89-5.11-14.89-15.45s6.19-16.15,16.71-16.15c3.16,0,5.15.3,7.62.87v4.59c-2.25-.74-4.16-1.17-7.96-1.17-7.4,0-11.12,4.29-11.12,11.47s3.38,11.6,10.21,11.6c1.86,0,3.51-.17,5.02-.43v-7.62h-5.97v-4.37h10.65Z" fill="white" strokeWidth="0"/><path d="M696.04,373.45c-9.64,0-15.39-5.96-15.39-15.95s6.43-16.64,17.21-16.64c3.25,0,5.29.32,7.73.88l.39.09v5.68l-.66-.21c-2.32-.76-4.17-1.14-7.81-1.14-6.95,0-10.62,3.79-10.62,10.97s3.27,11.1,9.71,11.1c1.52,0,3-.12,4.52-.36v-6.69h-5.97v-5.37h11.65v16.06l-.34.11c-3.15,1.04-6.37,1.5-10.41,1.5ZM697.86,341.85c-10.15,0-16.21,5.85-16.21,15.64s5.38,14.95,14.39,14.95c3.79,0,6.82-.41,9.76-1.34v-14.33h-9.65v3.37h5.97v8.54l-.42.07c-1.73.3-3.4.44-5.11.44-7.01,0-10.71-4.18-10.71-12.1s4.13-11.97,11.62-11.97c3.4,0,5.36.34,7.46.99v-3.5c-2.2-.49-4.14-.77-7.12-.77Z" fill="white" strokeWidth="0"/><path d="M1373.6,355.87v15.19c-2.77.91-5.89,1.47-10.26,1.47-8.7,0-14.89-5.11-14.89-15.45s6.19-16.15,16.71-16.15c3.16,0,5.15.3,7.62.87v4.59c-2.25-.74-4.16-1.17-7.96-1.17-7.4,0-11.12,4.29-11.12,11.47s3.38,11.6,10.21,11.6c1.86,0,3.51-.17,5.02-.43v-7.62h-5.97v-4.37h10.65Z" fill="white" strokeWidth="0"/><path d="M1363.34,373.04c-9.64,0-15.39-5.96-15.39-15.95s6.43-16.64,17.21-16.64c3.25,0,5.29.32,7.73.88l.39.09v5.68l-.66-.21c-2.32-.76-4.17-1.14-7.81-1.14-6.95,0-10.62,3.79-10.62,10.97s3.27,11.1,9.71,11.1c1.52,0,3-.12,4.52-.36v-6.69h-5.97v-5.37h11.65v16.06l-.34.11c-3.15,1.04-6.37,1.5-10.41,1.5ZM1365.16,341.44c-10.15,0-16.21,5.85-16.21,15.64s5.38,14.95,14.39,14.95c3.79,0,6.82-.41,9.76-1.34v-14.33h-9.65v3.37h5.97v8.54l-.42.07c-1.73.3-3.4.44-5.11.44-7.01,0-10.71-4.18-10.71-12.1s4.13-11.97,11.62-11.97c3.4,0,5.36.34,7.46.99v-3.5c-2.2-.49-4.14-.77-7.12-.77Z" fill="white" strokeWidth="0"/><polygon points="1280.9 371.62 1283.24 371.62 1291.65 354.35 1291.65 372 1297.14 372 1297.43 341.58 1291.61 341.58 1282.44 361.9 1272.99 341.58 1266.95 341.58 1266.95 372 1272.54 372 1272.54 353.88 1280.9 371.62" fill="white" strokeWidth="0"/><path d="M967.64,342.44l-8.95,29.43h-5.09l-4.67-16.94-4.58,16.94h-5.09l-9.46-29.43h5.42l6.26,22.15.42,2.35.38-2.35,4.58-17.19-1.35-4.96h4.83l5.63,22.15.38,2.23.42-2.23,5.84-22.15h5Z" fill="white" strokeWidth="0"/><path d="M959.05,372.37h-5.84l-4.28-15.54-4.2,15.54h-5.83l-9.78-30.43h6.49l6.28,22.23,4.46-16.76-1.48-5.46h5.88l5.65,22.21,5.86-22.21h6.06l-9.26,30.43ZM953.98,371.37h4.34l8.65-28.43h-3.94l-5.74,21.78-.93,4.93-.84-4.98-5.53-21.74h-3.79l1.21,4.46-.03.13-4.58,17.19-.83,5.21-.94-5.25-6.15-21.74h-4.36l9.14,28.43h4.34l4.96-18.34,5.05,18.34Z" fill="white" strokeWidth="0"/></svg>
);
